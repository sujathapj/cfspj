<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>ColdFusion, English documentation : Using Multiple Server Instances</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="page">
            <div id="main">
                <div id="main-header" class="pageSectionHeader">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ColdFusion, English documentation : Using Multiple Server Instances
                        </span>
                    </h1>

                    <div class="page-metadata">
                        <p>This page last changed on Sep 01, 2014 by <font color="#0050B2">charlie@carehart.org</font>.</p>
                    </div>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <p>If you install ColdFusion 11 with the <em>Server</em> configuration, you can create multiple instances and clusters, provided you have an Enterprise license or you install ColdFusion as a Trial or Developer edition. (ColdFusion Standard does not support multiple instances.)</p><p><span class="confluence-anchor-link" id="UsingMultipleServerInstances-backtotop"></span></p><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1427966370664 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1427966370664 ul {margin-left: 0px;padding-left: 10px;}
div.rbtoc1427966370664 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1427966370664'>
<ul>
    <li><a href='#UsingMultipleServerInstances-Aboutmultipleserverinstances'>About multiple server instances</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-Filelocationconsiderations'>File location considerations</a></li>
</ul>
    <li><a href='#UsingMultipleServerInstances-Definingadditionalserverinstances'>Defining additional server instances</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-Defineaserverinstance'>Define a server instance</a></li>
</ul>
    <li><a href='#UsingMultipleServerInstances-Enablingapplicationisolation'>Enabling application isolation</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-Usemultipleserverinstancesforapplicationisolation'>Use multiple server instances for application isolation</a></li>
    <li><a href='#UsingMultipleServerInstances-Webserverconfigurationforapplicationisolation'>Web server configuration for application isolation</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingIIS'>Configure multiple server instances for application isolation when using IIS</a></li>
    <li><a href='#UsingMultipleServerInstances-ConfiguringapplicationisolationinApache'>Configuring application isolation in Apache</a></li>
    <li><a href='#UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingApache'>Configure multiple server instances for application isolation when using Apache</a></li>
    <li><a href='#UsingMultipleServerInstances-ConfiguringapplicationisolationinSunONEWebServer'>Configuring application isolation in Sun ONE Web Server</a></li>
    <li><a href='#UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingSunONEWebServer'>Configure multiple server instances for application isolation when using Sun ONE Web Server</a></li>
</ul>
</ul>
    <li><a href='#UsingMultipleServerInstances-Enablingclusteringforloadbalancingandfailover'>Enabling clustering for load balancing and failover</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-Configureaclusterofserverinstancesforloadbalancingandfailover'>Configure a cluster of server instances for load balancing and failover</a></li>
<ul>
    <li><a href='#UsingMultipleServerInstances-Addingaremoteinstancetoacluster'>Adding a remote instance to a cluster</a></li>
</ul>
</ul>
    <li><a href='#UsingMultipleServerInstances-DefineremoteserverinstancestotheColdFusionAdministrator'>Define remote server instances to the ColdFusion Administrator</a></li>
</ul></div></p><hr /><p><strong><em><a href="Using%2BMultiple%2BServer%2BInstances.html">#back to top</a></em></strong></p><h2 id="UsingMultipleServerInstances-Aboutmultipleserverinstances">About multiple server instances</h2><p>The ColdFusion Administrator lets you create server instances and clusters. Additionally, you can connect to remote Tomcat servers and add them to clusters.<br /><br /> Running multiple instances of ColdFusion has the following advantages:</p><ul><li><strong>Application isolation</strong> You deploy an independent application to each server instance. Each server instance has separate settings and, because each server instance runs in its own Java Virtual Machine (JVM), problems that one application encounter have no effect on other applications.</li><li><strong>Clustering (load balancing and failover)</strong> You deploy the same application to each server instance and add the instances to a cluster. The web server connector optimizes performance and stability by automatically balancing load and by switching requests to another server instance when a server instance stops running.</li></ul><h3 id="UsingMultipleServerInstances-Filelocationconsiderations">File location considerations</h3><p>ColdFusion lets you store CFM pages either under the external web server root or under the ColdFusion web application root. The discussions here assume that you store your CFM pages under the ColdFusion web application root and specify a context root for your application.<br /> <br />For more information on serving CFM pages from the web server root, see <a href="Web%2BServer%2BManagement.html">Web Server Management</a></p><hr /><p><strong><em><a href="Using%2BMultiple%2BServer%2BInstances.html">#back to top</a></em></strong></p><h2 id="UsingMultipleServerInstances-Definingadditionalserverinstances">Defining additional server instances</h2><p>You can create multiple ColdFusion instances using the ColdFusion Administrator's Enterprise Manager page, which again is available only ColdFusion Enterprise, Trial, or Developer editions.</p><h3 id="UsingMultipleServerInstances-Defineaserverinstance">Define a server instance</h3><p>After installing ColdFusion in the <em>Server</em> (as opposed to JEE) configuration, create an instance of ColdFusion using the ColdFusion Administrator.</p><ol><li>In the ColdFusion Administrator, go to Enterprise Manager &gt; Instance Manager.</li><li>Click Add New Instance.</li><li>Enter the server name and server directory. (When you tab from the server name field, Javascript code in the Administrator will automatically append that name to the existing server directory location.)</li><li>(Optional) Check Create Windows Service.</li><li>Click Submit. Wait for the new instance to be created.</li><li>Once created, the new instance will be listed in the Instance Manager, where you can start, stop, restart, edit, delete, access the administrator, or access the web site for the instance (the latter two would be performed using the internal web server port for the instance, as selected by default by the Instance Manager).</li><li>(Optional) Click the Edit icon to edit the instance manager. Notice that you can e<span style="line-height: 13.0pt;">dit the internal webserver port as well as the load balancing factor.The load balancing factor represents the load the instance takes up and is applicable only if the instance is part of the cluster.For example, the load balancing factor for the first instance is 1 and that of the second instance is 2. The second instance receives two times more requests.</span></li><li>Click Submit.<hr /><strong><em><a href="Using%2BMultiple%2BServer%2BInstances.html">#back to top</a></em></strong></li></ol><h2 id="UsingMultipleServerInstances-Enablingapplicationisolation">Enabling application isolation</h2><p>You can create separate server instances, each with its own ColdFusion applications; each application then has its own ColdFusion and JEE server resources. In this configuration, you typically have a single external web server with multiple server instances on one computer, and separate virtual hosts (or sites) for each server instance.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>Like ColdFusion, other JEE application servers provide equivalent capabilities, and most of the concepts apply when deploying the ColdFusion JEE configuration on those JEE servers.</p></td></tr></table></div><p>Running independent applications this way has several advantages, including the following:</p><ul><li>Errors at the levels of the ColdFusion application or the Tomcat server do not affect any other ColdFusion applications.</li><li><p>You can support multihomed servers, where a single web server supports multiple IP addresses or domain names, such as www.mycompany.com and services.anothercompany.com, each running from a separate web root. For more information, see <a href="#WebServerManagement-Multihoming" rel="nofollow">Multihoming</a>.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p><em>Installing and Using ColdFusion</em> describes creating multiple server instances on a single computer. To create multiple server instances on separate computers, each computer requires a separate license of ColdFusion Enterprise Edition.</p></td></tr></table></div><p>To achieve complete application isolation, you use web-server-specific functionality to create a separate website for each application. Web servers have different terminology for this concept. For example, in IIS, you define separate websites, while in Apache, you create multiple virtual hosts.<br /> <br />These instructions apply when running ColdFusion in the Enterprise multiple instance configuration. The principles apply also when running ColdFusion on other JEE application serversl however, not all JEE application servers integrate with external web servers. For more information, see <a href="#WebServerManagement-Multihoming" rel="nofollow">Multihoming</a>.<br /> <br />These instructions assume that you deploy each application at a named context root, which enables users to access CFM pages by specifying http://_hostname_/_context-root_/_pagename_.cfm. If other web applications are running in the server instance, each web application must use a different context root.<br /> <br />For example, with a context root of <code>cf</code>, users access CFM pages by specifying http://_hostname_/cf/_pagename_.cfm. For more information on using a context root, see <em>Installing ColdFusion</em>.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>Although {{cf }}is the context root, it does not relate to your web application directory structure.</p></td></tr></table></div></li></ul><h3 id="UsingMultipleServerInstances-Usemultipleserverinstancesforapplicationisolation">Use multiple server instances for application isolation</h3><ol><li>Create a separate server instance by using the instructions in <a href="#UsingMultipleServerInstances-Definingadditionalserverinstances" rel="nofollow">Defining additional server instances</a>. If you are using the built-in web server, proceed to step 6 in the following steps.</li><li>Using your web-server-specific method, create a virtual website (or separate website) for the application. For more information, see <a href="#WebServerManagement-Multihoming" rel="nofollow">Multihoming</a>, or consult your web server documentation.</li><li>Test each virtual website to ensure that HTML pages are served correctly.</li><li>Store the ColdFusion files of your application the web root of the virtual website, or optionally in the ColdFusion web application root (for application portability).</li><li>Follow the instructions for your web server to configure the connection between your virtual website and the server instance. For more information, see <a href="#UsingMultipleServerInstances-Webserverconfigurationforapplicationisolation" rel="nofollow">Web server configuration for application isolation</a>.</li><li>Test your application.</li><li>Repeat these steps for each server instance.</li></ol><h3 id="UsingMultipleServerInstances-Webserverconfigurationforapplicationisolation">Web server configuration for application isolation</h3><p>When you use multiple server instances for application isolation, the steps you perform to configure communication between the website and the server instance differ for each web server.<br /><br /><span style="color: rgb(0,51,102);font-size: 12.0pt;font-weight: bold;line-height: normal;">Configuring application isolation in IIS</span></p><p>When you use multiple virtual websites with multiple server instances under IIS, you define separate filters and mappings for each virtual website and server instance combination.<br /> <br />It is assumed that you already created server instances and virtual websites, as described in <a href="#UsingMultipleServerInstances-Enablingapplicationisolation" rel="nofollow">Enabling application isolation</a>.</p><h4 id="UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingIIS">Configure multiple server instances for application isolation when using IIS</h4><p>Run the Web Server Configuration Tool multiple times, once for each virtual website. In ColdFusion 11, you must run the Web Server Configuration tool from within each instance (the wsconfig tool in <em>cfroot</em>\<em>instancename</em>\runtime\bin), and then specify the web site to connect to. use For more information on running the Web Server Configuration Tool, see <a href="#WebServerManagement-Usinganexternalwebserver" rel="nofollow">Using an external web server</a>.</p><h4 id="UsingMultipleServerInstances-ConfiguringapplicationisolationinApache">Configuring application isolation in Apache</h4><p>When you use multiple virtual hosts with multiple server instances under Apache, you edit the httpd.conf file manually.<br /> <br />It is assumed that you already created server instances and virtual websites, as described in <a href="#UsingMultipleServerInstances-Enablingapplicationisolation" rel="nofollow">Enabling application isolation</a>.</p><h4 id="UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingApache">Configure multiple server instances for application isolation when using Apache</h4><p>Assume that you have two instances: <code>cfusion</code> and <code>server1</code>.</p><ol><li>Configure Apache webserver for cfusion instance using the wsconfig tool. This step creates the connector-related files in the <code>cf_root\config\wsconfig\1</code> folder. It also creates the <code>mod_jk.conf</code> in the <code>&lt;Apacheroot&gt;\conf</code> folder. The <code>mod_jk.conf }}file is included in the {{httpd.conf</code>.</li><li>Configure Apache virtual hosts.<br /><ol><li>In <code>workers.properties</code> of <code>cf-root\config\wsconfig\1</code>, add <code>server1</code> to <code>workers.list</code>. For example, <code>worker.list=cfusion,server1</code>.</li><li><p>Add the following block:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: actionscript; gutter: false" style="font-size:12px;">worker.server1.type=ajp13 
worker.server1.host=localhost 
worker.server1.port=8014
</pre>
</div></div><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>The port is the AJP port for server1 and that can be found in server1.server.xml in the cf_root\server1\runtime\conf\server.xml.</p></td></tr></table></div></li><li>Copy the content of <code>uriworkermap.properties</code> in <code>cf-root\config\wsconfig\1</code> to{{ uriworkermap1.properties}}. Replace the cfusion with <code>server1</code>.</li><li>Now add the following line in each of the virtual host: For example, VH1 is the ColdFusion instance. It should have: <code>JkMountFile &quot;cf_root\config\wsconfig\1\uriworkermap.properties&quot;</code> VH2 is the server1 instance. It should have <code>JkMountFile &quot;cf_root\config\wsconfig\1&quot;</code>.</li></ol></li></ol><h4 id="UsingMultipleServerInstances-ConfiguringapplicationisolationinSunONEWebServer">Configuring application isolation in Sun ONE Web Server</h4><p>Under Sun ONE Web Server, each ColdFusion server instance is mapped to a Sub ONE Web Server instance, when you use multiple virtual hosts with multiple server instances.<br /> <br />It is assumed that you already created server instances, as described in <a href="#UsingMultipleServerInstances-Enablingapplicationisolation" rel="nofollow">Enabling application isolation</a>.</p><h4 id="UsingMultipleServerInstances-ConfiguremultipleserverinstancesforapplicationisolationwhenusingSunONEWebServer">Configure multiple server instances for application isolation when using Sun ONE Web Server</h4><p>Run the Web Server Configuration Tool for each Sun ONE Web Server instance. Specify a different configuration directory and ColdFusion server instance each time. Ensure that you select the Configure Web Server for ColdFusion MX Applications option (GUI).</p><hr /><p><strong><em><a href="Using%2BMultiple%2BServer%2BInstances.html">#back to top</a></em></strong></p><h2 id="UsingMultipleServerInstances-Enablingclusteringforloadbalancingandfailover">Enabling clustering for load balancing and failover</h2><p><em>Load balancing</em> is an enterprise-level feature in which the application server automatically alternates requests among the server instances in a cluster. Clustering also enables application servers to route requests to a running server instance when the original server instance goes down.<br /> <br />You can get New Admin API method to obtain instance name (getinstancename in runtime.cfc)load balancing and failover by deploying identical ColdFusion applications and configurations to multiple server instances and adding the instances to a cluster. Each instance must have the same applications deployed and the same resources configured (such as data sources, Solr collections, and mappings). The web server connector optimizes performance and stability by automatically balancing load and by switching requests to another server instance when a server instance stops running.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>You must be connected to a network for clustering to work.</p></td></tr></table></div><p>For maximum failover protection, use multiple computers in a cluster. However, you must purchase a separate ColdFusion Enterprise Edition license for each computer.<br /> <br />To implement session failover for the server instances in a cluster, enable session replication for each server instance. Session replication coordinates session information in real time among the server instances in a cluster. Enabling session replication lets Tomcat automatically route a request to a running server if the current server is unavailable.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>When a cluster uses session replication, session data is copied to other servers in the cluster each time it is modified. This can degrade performance if you store a significant amount of information in session scope. If you plan to store a significant amount of information in session scope, consider storing this information in client variables saved in a database.</p></td></tr></table></div><h3 id="UsingMultipleServerInstances-Configureaclusterofserverinstancesforloadbalancingandfailover">Configure a cluster of server instances for load balancing and failover</h3><p>Manage clusters using the ColdFusion Administrator.</p><ol><li> In the ColdFusion Administrator, click Enterprise Manager &gt; Cluster Manager.</li><li>Enter a cluster name and then click Add.</li><li>Click the cluster name and move the servers to the cluster based on the requirement.</li><li>(If required) Edit the multicast port.Multicast port is used to group the cluster members together. The default value of multicast port is 45564. After you create a cluster, the port is added in the <code><em>cfroot</em>\cfusion\config\cluster.xml</code> file. For more information on multicast port, see <a href="http://tomcat.apache.org/tomcat-6.0-doc/config/cluster-membership.html" class="external-link" rel="nofollow">http://tomcat.apache.org/tomcat-6.0-doc/config/cluster-membership.html</a>.</li><li>Specify if you need sticky session.Sticky session ensures that after a session is established on an instance, all future requests from the client are mapped to that instance. Note that if you disable sticky session, session replication will be enabled.</li><li>Click Submit.</li></ol><h4 id="UsingMultipleServerInstances-Addingaremoteinstancetoacluster">Adding a remote instance to a cluster</h4><p>To add a remote instance to a cluster, add the cluster block to the remote instance's <code>server.xml</code>. Then, register the remote instance and add the instance to the cluster. For more information on configuring clusters on Tomcat, see <a href="http://tomcat.apache.org/tomcat-5.5-doc/cluster-howto.html" class="external-link" rel="nofollow">http://tomcat.apache.org/tomcat-5.5-doc/cluster-howto.html</a>.<br /> <br />If you are using session replication, go to the Memory Variables page and enable J2EE sessions. Enable J2EE sessions for all server instances in the cluster. If J2EE sessions are not enabled in the ColdFusion Administrator, session replication does not function properly.<br /><br />CFC serialization lets you use J2EE session replication in a cluster and have access to the CFCs in session data across all instances in the cluster. Session replication also ensures that that Session scope variables are replicated across the cluster. However, session replication does not support replication of arrays in Session scope CFCs or variables.You can also preserve and access data in a CFC in the case of session failover. ColdFusion structures stored inside the session scope are available in the session scope, even after failover. <br /><br />For example, if you are running multiple ColdFusion instances to balance server load, you can store useful data, including CFCs, inside the session so that you can access the data across all the pages that are served in that session. To enable CFC serialization, set the CFC in the session, as follows:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: actionscript; gutter: false" style="font-size:12px;">&lt;cfset cfccomponent = CreateObject(&quot;component&quot;, &quot;CFIDE.adminapi.datasource&quot;)&gt; 
&lt;cfset session.datasourcecomponent = cfccomponent&gt;
</pre>
</div></div><p>After failover, you can then access and call methods in the CFC, as follows:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: actionscript; gutter: false" style="font-size:12px;">&lt;cfset check = session.datasourcecomponent.verifyDSN(&quot;testdsn&quot;)&gt;
</pre>
</div></div><ol><li>Register the remote instance to the local machine.</li><li>Create a cluster in the local machine.</li><li>Open the <code>cfroot_instance-name_runtime\conf\server.xml</code> file of the remote instance.</li><li><p>Add the following block between the entries <code>&lt;/host&gt; }}and {{&lt;/engine&gt;</code>:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="theme: Confluence; brush: actionscript; gutter: false" style="font-size:12px;"> 
&lt;Cluster className=&quot;org.apache.catalina.ha.tcp.SimpleTcpCluster&quot; 		channelSendOptions=&quot;8&quot;&gt; 
	&lt;Manager notifyListenersOnReplication=&quot;true&quot; expireSessionsOnShutdown=&quot;false&quot; className=&quot;org.apache.catalina.ha.session.DeltaManager&quot;&gt; 
	&lt;/Manager&gt; 
	&lt;Channel className=&quot;org.apache.catalina.tribes.group.GroupChannel&quot;&gt; 
		&lt;Membership port=&quot;45565&quot; dropTime=&quot;3000&quot; address=&quot;228.0.0.4&quot; 	className=&quot;org.apache.catalina.tribes.membership.McastService&quot; frequency=&quot;500&quot;&gt; 
		&lt;/Membership&gt; 
		&lt;Receiver port=&quot;4003&quot; autoBind=&quot;100&quot; address=&quot;auto&quot; selectorTimeout=&quot;5000&quot; 	maxThreads=&quot;6&quot; className=&quot;org.apache.catalina.tribes.transport.nio.NioReceiver&quot;&gt; 
		&lt;/Receiver&gt; 
		&lt;Sender className=&quot;org.apache.catalina.tribes.transport.ReplicationTransmitter&quot;&gt; 
			&lt;Transport className=&quot;org.apache.catalina.tribes.transport.nio.PooledParallelSender&quot;&gt; 
			&lt;/Transport&gt; 
		&lt;/Sender&gt; 
		&lt;Interceptor className=&quot;org.apache.catalina.tribes.group.interceptors.TcpFailureDetector&quot;&gt; 
		&lt;/Interceptor&gt; 
		&lt;Interceptor 	className=&quot;org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor&quot;&gt; 
		&lt;/Interceptor&gt; 
	&lt;/Channel&gt; 
	&lt;Valve className=&quot;org.apache.catalina.ha.tcp.ReplicationValve&quot; filter=&quot;&quot;&gt; 
	&lt;/Valve&gt; 
	&lt;Valve className=&quot;org.apache.catalina.ha.session.JvmRouteBinderValve&quot;&gt; 
	&lt;/Valve&gt; 
 
	&lt;ClusterListener 	className=&quot;org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener&quot;&gt; 
	&lt;/ClusterListener&gt; 
	&lt;ClusterListener className=&quot;org.apache.catalina.ha.session.ClusterSessionListener&quot;&gt; 
	&lt;/ClusterListener&gt; 
 
&lt;/Cluster&gt;  
</pre>
</div></div></li><li>In the entry, update the membership port with the multicast port of the cluster.</li><li><p>Using the ColdFusion Administrator of the local host, add the local instance and the remote instance to the cluster.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>If you enable sticky session, the JVM route of the remote instance and local instance must not be the same.</p></td></tr></table></div></li><li>Restart all the instances.</li></ol><div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Tip</b><br /><p>When running code in multiple instances, it can be useful to run CFML code that reports which instance is currently running a requested template. For security reasons, there is no function that provides the current instance name but the ColdFusion Admin API provides a method to obtain the instance name, the <em>getInstanceName</em> method in the <em>Runtime</em> CFC.  </p></td></tr></table></div><p> </p><hr /><p><strong><em><a href="Using%2BMultiple%2BServer%2BInstances.html">#back to top</a></em></strong></p><h2 id="UsingMultipleServerInstances-DefineremoteserverinstancestotheColdFusionAdministrator">Define remote server instances to the ColdFusion Administrator</h2><p>Register a new remote instance of ColdFusion using the ColdFusion Administrator.</p><ol><li>In the ColdFusion Administrator, click Enterprise Manager &gt; Instance Manager &gt; Register Remote Instance.</li><li><p>Specify the details such as instance name, remote host, remote port, http port, JVM route, and load balancing factor. <br /><br />Instance name is a string that is used to identify the instance. Remote port and HTTP port are displayed in the Instance Manager page. These ports are provided in the <code>server.xml</code> file available in the <code>runtime\conf</code> folder of the instance. Remote port is the AJP port and the instance port is the connector port.<br /><br />JVM route is the remote instance name. The JVM route is an attribute that acts as an identifier for a particular Tomcat worker. JVM route is provided in the <code>server.xml</code> file available in the <code>runtime\conf</code> folder of the instance. For more information on JVM route, see <a href="http://tomcat.apache.org/tomcat-5.5-doc/cluster-howto.html" class="external-link" rel="nofollow">http://tomcat.apache.org/tomcat-5.5-doc/cluster-howto.html</a>.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>A remote instance and a local instance cannot have the same JVM route if they are added in a cluster with sticky session enabled.</p></td></tr></table></div></li><li><p>If you want remote start and stop functionality over HTTP, enter Admin Component port, Admin Component user name, and Admin Component password. The default Admin Component port is 8985.</p><div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Note</b><br /><p>To enable this feature, install admin component on the remote host.</p></td></tr></table></div><p> </p><br /><ol><li>In the remote host, open the <code>cfroot\cfusion\jetty\etc\jetty.xml</code>.</li><li>Search for the string, <code>org.mortbay.jetty.bio.SocketConnector</code>.</li><li>Update the host with the IP address of the remote host.</li><li>Restart the jetty server.</li></ol></li><li>Click Submit.</li></ol><p> </p><div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>If you have configured ColdFusion 8/9/10 along with IIS for ALL sites, configuring ColdFusion 11 with IIS for ALL sites will not work. Also, i<span style="color: rgb(0,0,0);line-height: 13.0pt;">f you have configured ColdFusion 11 with IIS for ALL sites, configuring ColdFusion 8/9/10 with IIS for ALL sites will not work.</span></td></tr></table></div>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" style="background: url(https://wikidocs.adobe.com/wiki/images/border/border_bottom.gif) repeat-x;">
                <p><small>Document generated by Confluence on Apr 02, 2015 02:19</small></p>
            </div>
        </div>     </body>
</html>
